#!/usr/bin/haserl
<%in /usr/lib/web/libweb.sh %>
<% session_validate %>
<% response_headers %>
<%
xml_vap=`config_read /config/network`
vapnum=`config_getoption "$xml_vap" vapnum `
vapname="vap$vapnum"

for vap_allnum in `seq $NUM_ap`
do
	eval "xml_wlan_config_vap${vap_allnum}=\`config_read /config/network/vap${vap_allnum}\`"
	eval "xml_wlan_vap${vap_allnum}_enable=\`config_getoption \"\$xml_wlan_config_vap${vap_allnum}\" create\`"
done

xml_config=`config_read /config/network/$vapname`
xml_wlan_workmode=`config_getoption "$xml_config" wlanmode`

xml_config_apbw=`config_read /config/network/$vapname/bandwidth/apbw`
xml_apbw_enable=`config_getoption "$xml_config_apbw" apbwenable`
xml_apbw_maxclient=`config_getoption "$xml_config_apbw" maxclientrate`
xml_apbw_maxclient_send=`config_getoption "$xml_config_apbw" maxclientrate_send`

xml_config_estabw=`config_read /config/network/$vapname/bandwidth/estabw`
xml_estabw_enable=`config_getoption "$xml_config_estabw" estabwenable`
xml_stabw_enable=`config_getoption "$xml_config_estabw" stabwenable`
xml_estabw_maxbw=`config_getoption "$xml_config_estabw" maxbw`
xml_estabw_maxbw_send=`config_getoption "$xml_config_estabw" maxbw_send`
	  	  
xml_config_stabw1=`config_read /config/network/$vapname/bandwidth/stabw1`
xml_stabw1_mac=`config_getoption "$xml_config_stabw1" mac`
xml_stabw1_maxbw=`config_getoption "$xml_config_stabw1" maxbw`
xml_stabw1_maxbw_send=`config_getoption "$xml_config_stabw1" maxbw_send`
			  
xml_config_stabw2=`config_read /config/network/$vapname/bandwidth/stabw2`
xml_stabw2_mac=`config_getoption "$xml_config_stabw2" mac`
xml_stabw2_maxbw=`config_getoption "$xml_config_stabw2" maxbw`
xml_stabw2_maxbw_send=`config_getoption "$xml_config_stabw2" maxbw_send`
			  
xml_config_stabw3=`config_read /config/network/$vapname/bandwidth/stabw3`
xml_stabw3_mac=`config_getoption "$xml_config_stabw3" mac`
xml_stabw3_maxbw=`config_getoption "$xml_config_stabw3" maxbw`
xml_stabw3_maxbw_send=`config_getoption "$xml_config_stabw3" maxbw_send`
			  
xml_config_stabw4=`config_read /config/network/$vapname/bandwidth/stabw4`
xml_stabw4_mac=`config_getoption "$xml_config_stabw4" mac`
xml_stabw4_maxbw=`config_getoption "$xml_config_stabw4" maxbw`
xml_stabw4_maxbw_send=`config_getoption "$xml_config_stabw4" maxbw_send`
			  
xml_config_stabw5=`config_read /config/network/$vapname/bandwidth/stabw5`
xml_stabw5_mac=`config_getoption "$xml_config_stabw5" mac`
xml_stabw5_maxbw=`config_getoption "$xml_config_stabw5" maxbw`
xml_stabw5_maxbw_send=`config_getoption "$xml_config_stabw5" maxbw_send`
			  
xml_config_stabw6=`config_read /config/network/$vapname/bandwidth/stabw6`
xml_stabw6_mac=`config_getoption "$xml_config_stabw6" mac`
xml_stabw6_maxbw=`config_getoption "$xml_config_stabw6" maxbw`
xml_stabw6_maxbw_send=`config_getoption "$xml_config_stabw6" maxbw_send`
			  
xml_config_stabw7=`config_read /config/network/$vapname/bandwidth/stabw7`
xml_stabw7_mac=`config_getoption "$xml_config_stabw7" mac`
xml_stabw7_maxbw=`config_getoption "$xml_config_stabw7" maxbw`
xml_stabw7_maxbw_send=`config_getoption "$xml_config_stabw7" maxbw_send`
			  
xml_config_stabw8=`config_read /config/network/$vapname/bandwidth/stabw8`
xml_stabw8_mac=`config_getoption "$xml_config_stabw8" mac`
xml_stabw8_maxbw=`config_getoption "$xml_config_stabw8" maxbw`
xml_stabw8_maxbw_send=`config_getoption "$xml_config_stabw8" maxbw_send`
			  
xml_config_stabw9=`config_read /config/network/$vapname/bandwidth/stabw9`
xml_stabw9_mac=`config_getoption "$xml_config_stabw9" mac`
xml_stabw9_maxbw=`config_getoption "$xml_config_stabw9" maxbw`
xml_stabw9_maxbw_send=`config_getoption "$xml_config_stabw9" maxbw_send`



xml_session=`config_read /config/session`
xml_session_lang=`config_getoption "$xml_session" language`
%>

<html>
<head>
<%in page_title.htm %>
<link href="image/style.css" rel="stylesheet" type="text/css">
<% include_js qos_set.js %>
<script language="JavaScript" src="util.js" type="text/javascript"></script>
<script language="javascript">
	var flag="<%= $xml_session_lang %>";
var array_vapcreate=["<%= $xml_wlan_vap1_enable %>","<%= $xml_wlan_vap2_enable %>","<%= $xml_wlan_vap3_enable %>","<%= $xml_wlan_vap4_enable %>","<%= $xml_wlan_vap5_enable %>","<%= $xml_wlan_vap6_enable %>","<%= $xml_wlan_vap7_enable %>","<%= $xml_wlan_vap8_enable %>","<%= $xml_wlan_vap9_enable %>","<%= $xml_wlan_vap10_enable %>","<%= $xml_wlan_vap11_enable %>","<%= $xml_wlan_vap12_enable %>",];
var vapname="<%= $vapname %>";
var allvap_num="<%= $NUM_ap %>";
var work_mode="<%= $xml_wlan_workmode %>";
	init_mmenu(flag);
	init_basemenu(flag);
	init_lan(flag);
function Ip() 
{
	  document.all.vap_name.value=document.all.vapname.value;
	  overlayer();
}

function modify()
{
	if( work_mode != "sta" && work_mode != "client")
	{	
	  if(document.all.apbwenable[0].checked == true)
	  {
	  		document.getElementById("aplabel").style.display="";
	  		document.getElementById("aplabe2").style.display="";
	  }
	  else
	  {
	      document.getElementById("aplabel").style.display="none";
	      document.getElementById("aplabe2").style.display="none";
	  }
	  
	  if(document.all.estabwenable[0].checked == true)
	  {
	      document.getElementById("estalabel").style.display="";
	      document.getElementById("estalabe2").style.display="";
	  }
	  else
	  {
	      document.getElementById("estalabel").style.display="none";
	      document.getElementById("estalabe2").style.display="none";
	  }
	  
	  if(document.all.stabwenable[0].checked == true)
	  {
	  	 document.getElementById("tab").style.display="";
	  }
	  else
	  {
	  	 document.getElementById("tab").style.display="none";
	  }
	  document.getElementById("tab5").style.display="";
	} 
	else
	{
		document.getElementById("tab0").style.display="none";
		document.getElementById("tab").style.display="none";
		document.getElementById("tab5").style.display="none";
	} 
	  
} 

function vap_specific()
{
	 document.form0.onsubmit();
	 document.form0.action="action.cgi";
	 document.form0.submit(); 
}

function vapname_display()
{
	for(var i = 1;i <= allvap_num;i++)
	{
		if(array_vapcreate[i-1] == "yes")
		{
			var tmp_vapname="vap"+i;
			if(vapname == tmp_vapname)
			{
			 		document.write("<option value='"+tmp_vapname+"' selected='selected' >"+tmp_vapname+"</option>");
			}
			else
			{
				  document.write("<option value='"+tmp_vapname+"' >"+tmp_vapname+"</option>");
			}
	  }
	}
}
</script>
</head>
<body onLoad="modify()" >
<%in overlayer.htm %>
<%in page_header.htm %>
<%in menu_qos1.htm %>
<div align="center">
<table bgcolor="#f4f9fd" border="0"  cellpadding="0" cellspacing="0" width="774" >
<tr>
			<td  height="25">
			</td>
</tr>

<tr>
<td align="center"  bordercolor="#f4f9fd">

<div align="center">
<table bgcolor="#ffffff" align="center"  bordercolor="#90b5dd"  border="1" cellpadding="0" cellspacing="0" width="650">
	<tr>
		<td bordercolor="#456f95">	
			<form method="post" name="form0" action="<%= $action_cgi %>" onsubmit="return overlayer()">					
      <table id="tab1"  bgcolor="#ffffff" align="center"    border="0" cellpadding="0" cellspacing="0" width="650">                
			                 <tr>
												<td width="100%"  colspan="2" height="22" bgcolor="#456f95" bordercolor="#456f95"><b><script language="javascript">replace(qos_vap_choice)</script></b></td>
												</tr>
												
												<tr>
												<td colspan="2" height="10">
												</td>
												</tr>
												
												<tr>
													<td align="right" height="24" bordercolor="#ffffff" width="280"><script language="javascript">replace(qos_current_ap)</script>&nbsp;</td>
													<td  bordercolor="#ffffff" width="370">
													<select name="vapname" onChange="vap_specific()">
														<script language="JavaScript" type="text/javascript">vapname_display()</script>
													</select>	
													</td>
												</tr>
												
												
										    
										    
											</table>
			                  <input type="hidden" value="VAPSpec QQueue" name="SERVLET">
			                </form>
			                  <form method="post" name="form1" action="<%= $action_cgi %>" onsubmit="return Ip()">
			                  	<table  id="tab0" align="center"  border="0" cellpadding="0" cellspacing="0" width="650">
			                  <tr>
												<td width="100%"  colspan="2" height="22" bgcolor="#456f95" bordercolor="#456f95"><b><script language="javascript">replace(qos_vap_traffic_limit)</script></b></td>
												</tr>
												
												<tr>
												<td colspan="2" height="10">
												</td>
												</tr>
			                  
			                  <tr>
													<td align="right" height="24" bordercolor="#ffffff" width="280"><script language="javascript">replace(qos_vap_traffic_limit)</script>:&nbsp;</td>
													<td  bordercolor="#ffffff" width="370">
														<input type="radio" <% webui_radiobutton_check "$xml_apbw_enable" "1" %>  name="apbwenable" value="1" onClick="modify()"><script language="javascript">replace(qos_enable)</script>
														<input type="radio" <% webui_radiobutton_check "$xml_apbw_enable" "0" %>  name="apbwenable" value="0" onClick="modify()"><script language="javascript">replace(qos_disable)</script>
														</td>
												</tr>
			                  
			                  <tr id="aplabel">
													<td align="right" height="24" bordercolor="#ffffff"><script language="javascript">replace(qos_vap_traffic)</script>:&nbsp;</td>
													<td  bordercolor="#ffffff"><input type="text" name="apbw" size="7" maxlength="7" value="<%= "$xml_apbw_maxclient" %>">&nbsp;Kbps</td>
												</tr>
												<tr id="aplabe2">
													<td align="right" height="24" bordercolor="#ffffff"><script language="javascript">replace(qos_vap_traffic_send)</script>:&nbsp;</td>
													<td  bordercolor="#ffffff"><input type="text" name="apbw_send" size="7" maxlength="7" value="<%= "$xml_apbw_maxclient_send" %>">&nbsp;Kbps</td>
												</tr>
			                  
			                  <tr>
													<td colspan="2" height="10">
													</td>
													</tr>	
			                  
			                  <tr>
												<td width="100%"  colspan="2" height="22" bgcolor="#456f95" bordercolor="#456f95"><b><script language="javascript">replace(qos_user_traffic_limit)</script></b></td>
												</tr>
												
												<tr>
												<td colspan="2" height="10">
												</td>
												</tr>
			                  
			                  <tr>
													<td align="right" height="24" bordercolor="#ffffff"><script language="javascript">replace(qos_user_traffic_limit)</script>:&nbsp;</td>
													<td  bordercolor="#ffffff">
														<input type="radio" <% webui_radiobutton_check "$xml_estabw_enable" "1" %>  name="estabwenable" value="1" onClick="modify()"><script language="javascript">replace(qos_enable)</script>
														<input type="radio" <% webui_radiobutton_check "$xml_estabw_enable" "0" %>  name="estabwenable" value="0" onClick="modify()"><script language="javascript">replace(qos_disable)</script>
														</td>
												</tr>
			                  
			                  <tr id="estalabel">
													<td align="right" height="24" bordercolor="#ffffff"><script language="javascript">replace(qos_traffic)</script>:&nbsp;</td>
													<td  bordercolor="#ffffff"><input type="text" name="estabw" size="7" maxlength="7" value="<%= "$xml_estabw_maxbw" %>">&nbsp;Kbps</td>
												</tr>
												<tr id="estalabe2">
													<td align="right" height="24" bordercolor="#ffffff"><script language="javascript">replace(qos_traffic_send)</script>:&nbsp;</td>
													<td  bordercolor="#ffffff"><input type="text" name="estabw_send" size="7" maxlength="7" value="<%= "$xml_estabw_maxbw_send" %>">&nbsp;Kbps</td>
												</tr>
			                  
			                  <tr>
													<td colspan="2" height="10">
													</td>
													</tr>	
			                  	
			                   <tr>
												<td width="100%"  colspan="2" height="22" bgcolor="#456f95" bordercolor="#456f95"><b><script language="javascript">replace(qos_specif_traffic_limit)</script></b></td>
												</tr>
			                  
			                  <tr>
													<td colspan="2" height="10">
													</td>
													</tr>	
			                  
			                  <tr>
													<td align="right" height="24" bordercolor="#ffffff"><script language="javascript">replace(qos_specif_traffic_limit)</script>:&nbsp;</td>
													<td  bordercolor="#ffffff">
														<input type="radio" <% webui_radiobutton_check "$xml_stabw_enable" "1" %>  name="stabwenable" value="1" onClick="modify()"><script language="javascript">replace(qos_enable)</script>
														<input type="radio" <% webui_radiobutton_check "$xml_stabw_enable" "0" %>  name="stabwenable" value="0" onClick="modify()"><script language="javascript">replace(qos_disable)</script>
														</td>
												</tr>
			                  
			                  <tr>
													<td colspan="2" height="10">
													</td>
													</tr>
			                  </table>
		                    <table id="tab"  bgcolor="#ffffff" align="center"    border="0" cellpadding="0" cellspacing="0" width="650">
			                  <tr>
													<td align="right" height="24" bordercolor="#ffffff">MAC1:<input type="text" name="sta1" value="<%= "$xml_stabw1_mac" %>">&nbsp;</td>
													<td  bordercolor="#ffffff">&nbsp;<script language="javascript">replace(qos_traffic)</script>:<input type="text" name="stabw1" size="7" maxlength="7" value="<%= "$xml_stabw1_maxbw" %>">&nbsp;Kbps</td>
													<td  bordercolor="#ffffff">&nbsp;<script language="javascript">replace(qos_traffic_send)</script>:<input type="text" name="stabw1_send" size="7" maxlength="7" value="<%= "$xml_stabw1_maxbw_send" %>">&nbsp;Kbps</td>
												</tr>
												
												<tr>
													<td align="right" height="24" bordercolor="#ffffff">MAC2:<input type="text" name="sta2" value="<%= "$xml_stabw2_mac" %>">&nbsp;</td>
													<td  bordercolor="#ffffff">&nbsp;<script language="javascript">replace(qos_traffic)</script>:<input type="text" name="stabw2" size="7" maxlength="7" value="<%= "$xml_stabw2_maxbw" %>">&nbsp;Kbps</td>
													<td  bordercolor="#ffffff">&nbsp;<script language="javascript">replace(qos_traffic_send)</script>:<input type="text" name="stabw2_send" size="7" maxlength="7" value="<%= "$xml_stabw2_maxbw_send" %>">&nbsp;Kbps</td>
												</tr>
												
												<tr>
													<td align="right" height="24" bordercolor="#ffffff">MAC3:<input type="text" name="sta3" value="<%= "$xml_stabw3_mac" %>">&nbsp;</td>
													<td  bordercolor="#ffffff">&nbsp;<script language="javascript">replace(qos_traffic)</script>:<input type="text" name="stabw3" size="7" maxlength="7" value="<%= "$xml_stabw3_maxbw" %>">&nbsp;Kbps</td>
													<td  bordercolor="#ffffff">&nbsp;<script language="javascript">replace(qos_traffic_send)</script>:<input type="text" name="stabw3_send" size="7" maxlength="7" value="<%= "$xml_stabw3_maxbw_send" %>">&nbsp;Kbps</td>
												</tr>
												
												<tr>
													<td align="right" height="24" bordercolor="#ffffff">MAC4:<input type="text" name="sta4" value="<%= "$xml_stabw4_mac" %>">&nbsp;</td>
													<td  bordercolor="#ffffff">&nbsp;<script language="javascript">replace(qos_traffic)</script>:<input type="text" name="stabw4" size="7" maxlength="7" value="<%= "$xml_stabw4_maxbw" %>">&nbsp;Kbps</td>
													<td  bordercolor="#ffffff">&nbsp;<script language="javascript">replace(qos_traffic_send)</script>:<input type="text" name="stabw4_send" size="7" maxlength="7" value="<%= "$xml_stabw4_maxbw_send" %>">&nbsp;Kbps</td>
												</tr>
												
												<tr>
													<td align="right" height="24" bordercolor="#ffffff">MAC5:<input type="text" name="sta5" value="<%= "$xml_stabw5_mac" %>">&nbsp;</td>
													<td  bordercolor="#ffffff">&nbsp;<script language="javascript">replace(qos_traffic)</script>:<input type="text" name="stabw5" size="7" maxlength="7" value="<%= "$xml_stabw5_maxbw" %>">&nbsp;Kbps</td>
													<td  bordercolor="#ffffff">&nbsp;<script language="javascript">replace(qos_traffic_send)</script>:<input type="text" name="stabw5_send" size="7" maxlength="7" value="<%= "$xml_stabw5_maxbw_send" %>">&nbsp;Kbps</td>
												</tr>
												
												<tr>
													<td align="right" height="24" bordercolor="#ffffff">MAC6:<input type="text" name="sta6" value="<%= "$xml_stabw6_mac" %>">&nbsp;</td>
													<td  bordercolor="#ffffff">&nbsp;<script language="javascript">replace(qos_traffic)</script>:<input type="text" name="stabw6" size="7" maxlength="7" value="<%= "$xml_stabw6_maxbw" %>">&nbsp;Kbps</td>
													<td  bordercolor="#ffffff">&nbsp;<script language="javascript">replace(qos_traffic_send)</script>:<input type="text" name="stabw6_send" size="7" maxlength="7" value="<%= "$xml_stabw6_maxbw_send" %>">&nbsp;Kbps</td>
												</tr>
												
												<tr>
													<td align="right" height="24" bordercolor="#ffffff">MAC7:<input type="text" name="sta7" value="<%= "$xml_stabw7_mac" %>">&nbsp;</td>
													<td  bordercolor="#ffffff">&nbsp;<script language="javascript">replace(qos_traffic)</script>:<input type="text" name="stabw7" size="7" maxlength="7" value="<%= "$xml_stabw7_maxbw" %>">&nbsp;Kbps</td>
													<td  bordercolor="#ffffff">&nbsp;<script language="javascript">replace(qos_traffic_send)</script>:<input type="text" name="stabw7_send" size="7" maxlength="7" value="<%= "$xml_stabw7_maxbw_send" %>">&nbsp;Kbps</td>
												</tr>
												
												<tr>
													<td align="right" height="24" bordercolor="#ffffff">MAC8:<input type="text" name="sta8" value="<%= "$xml_stabw8_mac" %>">&nbsp;</td>
													<td  bordercolor="#ffffff">&nbsp;<script language="javascript">replace(qos_traffic)</script>:<input type="text" name="stabw8" size="7" maxlength="7" value="<%= "$xml_stabw8_maxbw" %>">&nbsp;Kbps</td>
													<td  bordercolor="#ffffff">&nbsp;<script language="javascript">replace(qos_traffic_send)</script>:<input type="text" name="stabw8_send" size="7" maxlength="7" value="<%= "$xml_stabw8_maxbw_send" %>">&nbsp;Kbps</td>
												</tr>
												
												<tr>
													<td align="right" height="24" bordercolor="#ffffff">MAC9:<input type="text" name="sta9" value="<%= "$xml_stabw9_mac" %>">&nbsp;</td>
													<td  bordercolor="#ffffff">&nbsp;<script language="javascript">replace(qos_traffic)</script>:<input type="text" name="stabw9" size="7" maxlength="7" value="<%= "$xml_stabw9_maxbw" %>">&nbsp;Kbps</td>
													<td  bordercolor="#ffffff">&nbsp;<script language="javascript">replace(qos_traffic_send)</script>:<input type="text" name="stabw9_send" size="7" maxlength="7" value="<%= "$xml_stabw9_maxbw_send" %>">&nbsp;Kbps</td>
												</tr>
			                  
											    <tr>
													<td colspan="2" height="10">
													</td>
													</tr>	
		</table>
		</td>
   </tr>
</table>
		<table id="tab5"  align="center"  border="0" cellpadding="0" cellspacing="0" width="650">	
			<tr>
			  <td align="center" height="40" valign="middle" colspan="2" ><script language="javascript" >replace(b_lansu)</script>&nbsp;</td>
			</tr>
			<tr>
        <td align="right"   colspan="2"><script language="javascript">replace(queue_help)</script></td>
      </tr>
		</table>
		<input type="hidden" value="QQueue Setup" name="SERVLET">
		<input type="hidden" name="vap_name" value="">
		</form>
</div>


</td>
</tr>

<tr>
			<td  height="25">
			</td>
</tr>
</table>
</div>
<%in page_footer.htm %>
</body>
</html>

