#!/usr/bin/haserl
<%in /usr/lib/web/libweb.sh %>
<% session_validate %>
<% response_headers %>

<%
xml_session=`config_read /config/session`
xml_session_lang=`config_getoption "$xml_session" language`
[ -f /jffs/config.xml_bak ]&&file_exist=1
%>

<html>
<head>
<%in page_title.htm %>
<link href="image/style.css" rel="stylesheet" type="text/css">
<% include_js admin_set.js %>
<script language="JavaScript" src="util.js" type="text/javascript"></script>
<script language="JavaScript">
var flag="<%= $xml_session_lang %>";
 init_mmenu(flag);
	init_adminmenu(flag);
init_backst(flag);	
function valvalidate()
{
 var x =document.getElementById("uploadfile").value;
	  if(x == "")
	  {      
	  	  alert(backst_alert_config_null);
	  	  return false;
   	}
   	else
   	{
   	if(!/\.(xml)$/.test(x))
   	{alert("备份文件默认为XML格式，请重新上传");
   	return false;
   	}
   	}
   	
   	overlayer();
} 

function filevalidate()
{
		var file_exist="<%= $file_exist %>";
		if(file_exist != 1)
		{
			  alert(backst_alert_file_back);
			  return false;
		}

		overlayer();
}
</script>
</head>
<body>
<%in overlayer.htm %>
<%in page_header.htm %>
<%in menu_administration1.htm %>
<div align="center">
<table bgcolor="#f4f9fd" border="0"  cellpadding="0" cellspacing="0" width="774" >
<tr>
			<td  height="25">
			</td>
</tr>

<tr>
<td align="center"  bordercolor="#f4f9fd">

<div align="center">
<table bgcolor="#ffffff" align="center"  bordercolor="#90b5dd"  border="1" cellpadding="0" cellspacing="0">
							<tr>
							<td width="100%" align="center" colspan="2" height="22" bgcolor="#456f95" bordercolor="#456f95"><b><script language="javascript">replace(backst_title)</script></b></td>
							</tr>
							
							<tr>
							<td colspan="2" height="10">
							</td>
							</tr>
							<form method="post" action="<%= $action_cgi %>" enctype="multipart/form-data" >
							<tr>
							<td align="right" height="24" width="280" bordercolor="#ffffff"><script language="javascript">replace(backst_save)</script>&nbsp;</td>
							<td  width="370" bordercolor="#ffffff"><script language="javascript">replace(backst_save1)</script></td>
							</tr>
							</form>
							<form method="post" action="<%= $action_cgi %>" enctype="multipart/form-data" onsubmit="return valvalidate()">
							<tr>
							<td align="right" height="24" bordercolor="#ffffff"><script language="javascript">replace(backst_restore)</script>&nbsp;</td>
							<td bordercolor="#ffffff"><input type="file" name="uploadfile">&nbsp;<script language="javascript">replace(backst_restore1)</script></td>
							</tr>
							<input type="hidden" name="SERVLET" value="Restore">
							</form>
							
							<form method="post" action="<%= $action_cgi %>"  >
							<tr>
							<td align="right" height="24" width="280" bordercolor="#ffffff"><script language="javascript">replace(backst_save2)</script>&nbsp;</td>
							<td  width="370" bordercolor="#ffffff"><script language="javascript">replace(backst_save3)</script></td>
							</tr>
							<input type="hidden" name="SERVLET" value="backup in device">
							</form>
							<form method="post" action="<%= $action_cgi %>"  onsubmit="return filevalidate()">
							<tr>
							<td align="right" height="24" bordercolor="#ffffff"><script language="javascript">replace(backst_restore2)</script>&nbsp;</td>
							<td bordercolor="#ffffff"><script language="javascript">replace(backst_restore3)</script></td>
							</tr>
							<input type="hidden" name="SERVLET" value="restore in device">
							</form>
							
							<form method="post" action="<%= $action_cgi %>" enctype="multipart/form-data" >
							<tr>
							<td align="right" height="24" bordercolor="#ffffff"><script language="javascript">replace(backst_reset)</script>&nbsp;</td>
							<td bordercolor="#ffffff"><script language="javascript">replace(backst_reset1)</script></td>
							</tr>
							<input type="hidden" name="SERVLET" value="Reset Default">
							</form>
							<tr>
							<td colspan="2" height="10">
							</td>
							</tr>
</table>
<table  align="center"  border="0" cellpadding="0" cellspacing="0" width="650">	
			<tr>
								<td colspan="2" height="20">
								</td>
			</tr>
			<tr>
        <td align="right"   colspan="2"><script language="javascript">replace(backst_help)</script></td>
      </tr>
</table>
</div>

</td>
</tr>

<tr>
			<td  height="25">
			</td>
</tr>
</table>
</div>

<%in page_footer.htm %>
</body>
</html>

