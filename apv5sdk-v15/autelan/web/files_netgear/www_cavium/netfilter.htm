#!/usr/bin/haserl
<%in /usr/lib/web/libweb.sh %>
<% session_validate %>
<% response_headers %>

<%
xml_netrule=`config_read /config/netsecury/netfilter`
xml_netrule_count=`config_getoption "$xml_netrule" fcount`
xml_netrule_fdefault=`config_getoption "$xml_netrule" forwardefault`
for fornum in `seq $xml_netrule_count`
do
	eval LINE$fornum=\"`config_getoption "$xml_netrule" forule$fornum 2>/dev/null`\"
done
  	
xml_session=`config_read /config/session`
xml_session_lang=`config_getoption "$xml_session" language`
%>


<html>
<head>
<%in page_title.htm %>
<link href="image/style.css" rel="stylesheet" type="text/css">
<% include_js access_control.js %>
<script language="JavaScript" src="util.js" type="text/javascript"></script>
<script language="javascript">
var flag="<%= $xml_session_lang %>";
init_mmenu(flag);
init_acmenu(flag);
init_accessec(flag);
var array1=["<%= $LINE1 %>","<%= $LINE2 %>","<%= $LINE3 %>","<%= $LINE4 %>","<%= $LINE5 %>","<%= $LINE6 %>","<%= $LINE7 %>","<%= $LINE8 %>","<%= $LINE9 %>","<%= $LINE10 %>","<%= $LINE11 %>","<%= $LINE12 %>","<%= $LINE13 %>","<%= $LINE14 %>","<%= $LINE15 %>","<%= $LINE16 %>","<%= $LINE17 %>","<%= $LINE18 %>","<%= $LINE19 %>","<%= $LINE20 %>"];
function loadtable()
{

	document.all.fdpolicy.value="<%= $xml_netrule_fdefault %>";
  var tl=document.getElementById("tableList"); 
  var count=parseInt(document.all.rulecount.value);
  for(i=1;i<=count;i++)   
  {
  	var rule="rule"+i;
		document.getElementById(rule).value=array1[i-1];
  	str=array1[i-1].split("%"); 
	  for(j=0;j<9;j++)   
	  { 
	  	 if(j == 8) 
	  	 {
	  	 	  var obj1 = document.createElement("INPUT");
				  obj1.type = "button";
				  obj1.name = "del"+i;
				  obj1.id = "del"+i; 
				  obj1.value = "del";
				  obj1.onclick = function(){return delrule(this);}
	  	 	  tl.rows[i].cells[j].appendChild(obj1);
	  	 }
	  	 else if(j>=2&&j<=5)
	  	 {
	  	 	   var cstr=str[j].split("/");
	  	 	   tl.rows[i].cells[j].innerText=cstr[0];
	  	 }
	  	 else
	  	 {   
	      tl.rows[i].cells[j].innerText=str[j];
	     }   
	  }   
  }    
}  

function add()
{
	
  var tl=document.getElementById("tableList"); 
  var count=parseInt(document.all.rulecount.value)+1;
  if(count>20)
  {
  	alert(accessec_alert);
  	return false;
  }
  if( document.all.nftype[0].checked == true )
  {
		  var at1="-";
		  var at2="-";
		  var at3=document.all.macsrc.value;
		  var at4=document.all.macdst.value;
		  var at5="-";
		  var at6="-";
		  var at7="---";
		  var at8=document.all.decision.value;
		  if(at3=="")
		    at3="-";
		  if(at4=="")
		    at4="-"; 
		  if(at8=="")
		    at8="-"; 
  }
  else if( document.all.nftype[1].checked == true )
  {
  		var at1="-";
		  var at2="-";
		  var at3="-";
		  var at4="-";
		  var at5=document.all.ipsrc.value;
		  var at6=document.all.ipdst.value;
		  var at7="---";
		  var at8=document.all.decision.value;
		  if(at5=="")
		    at5="-";
		  if(at6=="")
		    at6="-";
		  if(at8=="")
		    at8="-"; 
  }
  else
  {
  		var at1=document.all.ifin.value;
		  var at2=document.all.ifout.value;
		  var at3=document.all.macsrc.value;
		  var at4=document.all.macdst.value;
		  var at5=document.all.ipsrc.value;
		  var at6=document.all.ipdst.value;
		  var at7=document.all.dgtype.value+"-"+document.all.sport.value+"-"+document.all.dport.value;
		  var at8=document.all.decision.value;
		  
		  if(at1=="")
		    at1="-";
		  if(at2=="")
		    at2="-";
		  if(at3=="")
		    at3="-";
		  if(at4=="")
		    at4="-"; 
		  if(at5=="")
		    at5="-";
		  if(at6=="")
		    at6="-";
		  if(at7=="--")
		    at7="---";
		  if(at8=="")
		    at8="-"; 
  }
  var arr=[at1,at2,at3,at4,at5,at6,at7,at8];
	  for(j=0;j<9;j++)   
	  { 
	  	 if(j == 8) 
	  	 {
	  	 	  var obj1 = document.createElement("INPUT");
				  obj1.type = "button";
				  obj1.name = "del"+count;
				  obj1.id = "del"+count; 
				  obj1.value = "del";
				  obj1.onclick = function(){return delrule(this);}
	  	 	  tl.rows[count].cells[j].appendChild(obj1);
	  	 }
	  	 else if(j>=2&&j<=5)
	  	 {
	  	 	   var cstr=arr[j].split("/");
	  	 	   tl.rows[count].cells[j].innerText=cstr[0];
	  	 }
	  	 else
	  	 {   
	      tl.rows[count].cells[j].innerText=arr[j];
	     }   
	  }
	  document.all.rulecount.value = count;  
	  document.all.rulecount1.value = count; 
	  var crule="rule"+count;
	  document.getElementById(crule).value=arr[0]+"%"+arr[1]+"%"+arr[2]+"%"+arr[3]+"%"+arr[4]+"%"+arr[5]+"%"+arr[6]+"%"+arr[7];
	  
}

function getParent(myElement,myTagName)
{
   
	if(myElement.tagName == "BODY")
	{
	    
	    return false;
	}
	
	if(myElement.tagName == myTagName)
	{
	    return myElement;
	}
	else
	{
	    return getParent(myElement.parentElement,myTagName);
	}
}

function delrule(btobject)
{
   var str1=btobject.name.split("l");
   var myTr = getParent(btobject,"TR"); 
	 if(myTr != false)
	 {
		   myTr.parentElement.removeChild(myTr);	   
	 }  

   var trHeader = tableList.insertRow();
   for(var i=1;i<=9;i++)
   {
		   var tdHeader = trHeader.insertCell();
		   tdHeader.borderColor = "#1efffe";
		   tdHeader.align = "center";
   }
   
	 var tmp=parseInt(str1[1])+1;
	 var count=parseInt(document.all.rulecount.value);
	 for(var p=tmp;p<=count;p++)
	 {
			var str = "del"+p;
			var strt = p-1;
			var tmprule="rule"+p;
			var assignrule="rule"+strt;
		  document.getElementById(str).name = "del"+strt;
			document.getElementById(str).id = "del"+strt;
			document.getElementById(assignrule).value=document.getElementById(tmprule).value;
	 }
	 document.all.rulecount.value = count-1;
	 document.all.rulecount1.value = count-1;

}

function shielding()
{
   if(document.all.nftype[0].checked == true){      
	  document.getElementById("a1").style.display="none";
	  document.getElementById("a2").style.display="";
	  document.getElementById("a6").style.display="";
	  document.getElementById("a3").style.display="none";
	  document.getElementById("a4").style.display="none";
	  document.getElementById("a5").style.display="none";
	  document.getElementById("a7").style.display="none";
	  document.getElementById("a8").style.display="none";
	  }
	else if(document.all.nftype[1].checked == true){
	  document.getElementById("a1").style.display="none";
	  document.getElementById("a2").style.display="none";
	  document.getElementById("a3").style.display="";
	  document.getElementById("a7").style.display="";
	  document.getElementById("a4").style.display="none";
	  document.getElementById("a5").style.display="none"; 
	  document.getElementById("a8").style.display="none";
	  document.getElementById("a6").style.display="none";
	  }
	else
	{
	  document.getElementById("a1").style.display="";
	  document.getElementById("a2").style.display="";
	  document.getElementById("a3").style.display="";
	  document.getElementById("a4").style.display="";
	  document.getElementById("a6").style.display="";
	  document.getElementById("a7").style.display="";
	  if(document.all.dgtype.value == "TCP" ||document.all.dgtype.value == "UDP")
	  {
	    document.getElementById("a5").style.display="";
	    document.getElementById("a8").style.display="";
	  }
	  else
	  {
	    document.getElementById("a5").style.display="none";
	    document.getElementById("a8").style.display="none";
	  }
	   
	}
    
}

function mpolicy()
{
	if(document.all.fdpolicy.value == "")
	  document.all.defpolicy.value="ACCEPT";
	else
	  document.all.defpolicy.value=document.all.fdpolicy.value;	
overlayer();
}

function validate()
{
	 var m1=document.all.macsrc.value;
	 var m2=document.all.macdst.value;
	 var ip1=document.all.ipsrc.value;
	 var ip2=document.all.ipdst.value;
	 var p1=document.all.sport.value;
	 var p2=document.all.dport.value;
	 
	overlayer();
}

</script>
</head>
<body onload="shielding();loadtable()">
<%in overlayer.htm %>
<%in page_header.htm %>
<%in menu_accontrol1.htm %>
<div align="center">
<table bgcolor="#f4f9fd" border="0"  cellpadding="0" cellspacing="0" width="774" >
<tr>
			<td  height="25">
			</td>
</tr>

<tr>
<td align="center"  bordercolor="#f4f9fd">
<div align="center">
<table bgcolor="#ffffff" align="center"  bordercolor="#90b5dd"  border="1" cellpadding="0" cellspacing="0" width="650">
	<tr>
		<td bordercolor="#d9d9d9">						
       <table  bgcolor="#ffffff" align="center"    border="0" cellpadding="0" cellspacing="0" width="650">
	     <tr>
			<td width="100%" align="left" colspan="2" height="22" bgcolor="#d9d9d9" bordercolor="#d9d9d9"><b><script language="javascript">replace(accessec_title)</script></b></td>
			</tr>
			
			<tr>
				<td  height="10" colspan="2">
				</td>
	      </tr>
	    
	     <tr>
					<td align="right"  height="28" bordercolor="#ffffff" width="220"><script language="javascript">replace(accessec_dpolicy)</script>&nbsp;
					</td><td align="left"   bordercolor="#ffffff" width="430"><select name="fdpolicy" >
					<option  value="ACCEPT" >Allow</option>
					<option  value="DROP" >prevent</option>
					</select>
					</td>
			</tr>
	     
	     <tr>
				<td  height="10" colspan="2">
				</td>
	      </tr>
	      
	      <tr>
			<td width="100%" align="left" colspan="2" height="22" bgcolor="#d9d9d9" bordercolor="#d9d9d9"><b><script language="javascript">replace(accessec_addrule)</script></b></td>
			</tr>
			
	     <tr>
				<td  height="10" colspan="2">
				</td>
	      </tr>
	      
	     <tr>
					<td align="right"  height="28" bordercolor="#ffffff" ><script language="javascript">replace(accessec_ftype)</script>&nbsp;
					</td><td align="left"   bordercolor="#ffffff" ><input type="radio"  name="nftype" value="MAC" onClick="shielding()" checked>MAC&nbsp;
					<input type="radio"  name="nftype" value="IP" onClick="shielding()">IP&nbsp;
					<input type="radio"  name="nftype" value="Advance" onClick="shielding()">Advance&nbsp;
					</td>
			</tr>
			
			<tr id="a1">
					<td align="right"  height="28" bordercolor="#ffffff" ><script language="javascript">replace(accessec_ifin)</script>&nbsp;
					</td><td align="left"   bordercolor="#ffffff" ><select name="ifin" >
					<option  value="" >none</option>
					<option  value="ath0" >vap1</option>
					<option  value="ath1">vap2</option>
					<option  value="ath2">vap3</option>
					<option  value="ath3">vap4</option>
					<option  value="ath4">vap5</option>
					<option  value="ath5">vap6</option>
					<option  value="ath6">vap7</option>
					<option  value="eth0">eth0</option>
					<option  value="eth1">eth1</option>
					<option  value="! ath0" >!vap1</option>
					<option  value="! ath1">!vap2</option>
					<option  value="! ath2">!vap3</option>
					<option  value="! ath3">!vap4</option>
					<option  value="! ath4">!vap5</option>
					<option  value="! ath5">!vap6</option>
					<option  value="! ath6">!vap7</option>
					<option  value="! eth0">!eth0</option>
					<option  value="! eth1">!eth1</option>
					</select>
					&nbsp;&nbsp;&nbsp;<script language="javascript">replace(accessec_ifout)</script>&nbsp;
					<select name="ifout" >
					<option  value="" >none</option>
					<option  value="ath0" >vap1</option>
					<option  value="ath1">vap2</option>
					<option  value="ath2">vap3</option>
					<option  value="ath3">vap4</option>
					<option  value="ath4">vap5</option>
					<option  value="ath5">vap6</option>
					<option  value="ath6">vap7</option>
					<option  value="eth0">eth0</option>
					<option  value="eth1">eth1</option>
					<option  value="! ath0" >!vap1</option>
					<option  value="! ath1">!vap2</option>
					<option  value="! ath2">!vap3</option>
					<option  value="! ath3">!vap4</option>
					<option  value="! ath4">!vap5</option>
					<option  value="! ath5">!vap6</option>
					<option  value="! ath6">!vap7</option>
					<option  value="! eth0">!eth0</option>
					<option  value="! eth1">!eth1</option>
					</select>
					</td>
			</tr>
			
			<tr id="a2">
			<td align="right" height="28" bordercolor="#ffffff" ><script language="javascript">replace(accessec_smac)</script>&nbsp;
			</td><td align="left"  bordercolor="#ffffff" ><input type="text" name="macsrc"  >
			</tr>
			
			<tr id="a6">
			<td align="right" height="28" bordercolor="#ffffff" ><script language="javascript">replace(accessec_dmac)</script>&nbsp;
			</td><td align="left"  bordercolor="#ffffff" ><input type="text" name="macdst"  ></td>
			</tr>
			
			<tr id="a3">
			<td align="right" height="28" bordercolor="#ffffff" >&nbsp;<script language="javascript">replace(accessec_sip)</script>&nbsp;
			</td><td align="left"  bordercolor="#ffffff" ><input type="text" name="ipsrc"  >
			</tr>
			
			<tr id="a7">
			<td align="right" height="28" bordercolor="#ffffff" ><script language="javascript">replace(accessec_dip)</script>&nbsp;
			</td><td align="left"  bordercolor="#ffffff" ><input type="text" name="ipdst"  ></td>
			</tr>
			
			<tr id="a4">
					<td align="right"  height="28" bordercolor="#ffffff" >&nbsp;&nbsp;<script language="javascript">replace(accessec_dgtype)</script>&nbsp;
					</td><td align="left"   bordercolor="#ffffff" ><select name="dgtype" onChange="shielding()">
					<option  value="" >none</option>
					<option  value="IP" >IP</option>
					<option  value="TCP">TCP</option>
					<option  value="UDP">UDP</option>
					<option  value="ICMP">ICMP</option>
					<option  value="IGMP">IGMP</option>
					<option  value="! IP" >!IP</option>
					<option  value="! TCP">!TCP</option>
					<option  value="! UDP">!UDP</option>
					<option  value="! ICMP">!ICMP</option>
					<option  value="! IGMP">!IGMP</option>
					</select>
					</td>
			</tr>
			
			<tr id="a5">
			<td align="right" height="28" bordercolor="#ffffff">&nbsp;<script language="javascript">replace(accessec_sport)</script>&nbsp;
			</td><td align="left"  bordercolor="#ffffff" ><input type="text" name="sport"  ></td>
			</tr>
			
			<tr id="a8">
			<td align="right" height="28" bordercolor="#ffffff"><script language="javascript">replace(accessec_dport)</script>&nbsp;
			</td><td align="left"  bordercolor="#ffffff" ><input type="text" name="dport"  ></td>
			</tr>
	      
	    <tr>
					<td align="right"  height="28" bordercolor="#ffffff" ><script language="javascript">replace(accessec_cpolicy)</script>&nbsp;
					</td><td align="left"   bordercolor="#ffffff" ><select name="decision" >
					<option  value="ACCEPT" >Allow</option>
					<option  value="DROP">prevent</option>
					</select>
					</td>
			</tr>
			
			<tr>
					<td align="right" colspan="2" height="28" bordercolor="#ffffff" ><script language="javascript">replace(accessec_add)</script>&nbsp;</td>
			</tr>
			
			<tr>
				<td  height="10" colspan="2">
				</td>
	      </tr>
	      
	      <tr>
			<td width="100%" align="left" colspan="2" height="22" bgcolor="#d9d9d9" bordercolor="#d9d9d9"><b><script language="javascript">replace(accessec_hrule)</script></b></td>
			</tr>
			</table>
			<input type="hidden" value="<%= $xml_netrule_count %>" name="rulecount1" >
		    <table name="tableList" id="tableList"  align="center"  border="1" cellpadding="0" cellspacing="0" width="650">	      
	      <tr >
				<td  align="center" width="50"  bordercolor="#d9d9d9">Input</td>				
				<td  align="center" width="50"  bordercolor="#d9d9d9">Output</td>				
				<td  align="center" width="110"  bordercolor="#d9d9d9">src MAC/mask</td>				
				<td  align="center" width="110"  bordercolor="#d9d9d9">dst MAC/mask</td>				
				<td  align="center" width="100"  bordercolor="#d9d9d9">src IP/mask</td>
				<td  align="center" width="100"  bordercolor="#d9d9d9">dst IP/mask</td>	
				<td  align="center" width="60"  bordercolor="#d9d9d9">proto</td>
				<td  align="center" width="50"  bordercolor="#d9d9d9">policy</td>
				<td  align="center" width="20"  bordercolor="#d9d9d9">\</td>
				</tr>
				
				<tr id="t1">
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>	
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>
				</tr>
				<tr id="t2">
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>	
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>
				</tr>
				<tr id="t3">
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>	
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>
				</tr>
				<tr id="t4">
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>	
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>
				</tr>
				<tr id="t5">
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>	
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>
				</tr>
				<tr id="t6">
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>	
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>
				</tr>
				<tr id="t7">
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>	
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>
				</tr>
				<tr id="t8">
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>	
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>
				</tr>
				<tr id="t9">
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>	
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>
				</tr>
				<tr id="t10">
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>	
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>
				</tr>
				<tr id="t11">
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>	
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>
				</tr>
				<tr id="t12">
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>	
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>
				</tr>
				<tr id="t13">
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>	
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>
				</tr>
				<tr id="t14">
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>	
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>
				</tr>
				<tr id="t15">
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>	
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>
				</tr>
				<tr id="t16">
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>	
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>
				</tr>
				<tr id="t17">
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>	
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>
				</tr>
				<tr id="t18">
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>	
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>
				</tr>
				<tr id="t19">
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>	
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>
				</tr>
				<tr id="t20">
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>				
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>	
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>
				<td  align="center"   bordercolor="#d9d9d9"></td>
				</tr>
				</table>
			</td>
    </tr>
</table> 
<form name="form2" method="post" action="<%= $action_cgi %>" onsubmit="return mpolicy()">  
<table  align="center"  border="0" cellpadding="0" cellspacing="0" width="650">	
				<tr>
				<td  align="center" height="40" valign="middle" ><script language="javascript">replace(accessec_apply)</script>&nbsp;</td>
				</tr>
				<tr>
        <td align="right"   colspan="2"><script language="javascript">replace(accessec_help)</script></td>
      </tr>
</table>
<input type="hidden" value="Netfilter Setup" name="SERVLET" >
<input type="hidden" value="old" name="updateflag" >
<input type="hidden" value="ACCEPT" name="defpolicy" >
				<input type="hidden" value="<%= $xml_netrule_count %>" name="rulecount" >
<input type="hidden" value="" name="rule1" id="rule1">
<input type="hidden" value="" name="rule2" id="rule2">
<input type="hidden" value="" name="rule3" id="rule3">
<input type="hidden" value="" name="rule4" id="rule4">
<input type="hidden" value="" name="rule5" id="rule5">
<input type="hidden" value="" name="rule6" id="rule6">
<input type="hidden" value="" name="rule7" id="rule7">
<input type="hidden" value="" name="rule8" id="rule8">
<input type="hidden" value="" name="rule9" id="rule9">
<input type="hidden" value="" name="rule10" id="rule10">
<input type="hidden" value="" name="rule11" id="rule11">
<input type="hidden" value="" name="rule12" id="rule12">
<input type="hidden" value="" name="rule13" id="rule13">
<input type="hidden" value="" name="rule14" id="rule14">
<input type="hidden" value="" name="rule15" id="rule15">
<input type="hidden" value="" name="rule16" id="rule16">
<input type="hidden" value="" name="rule17" id="rule17">
<input type="hidden" value="" name="rule18" id="rule18">
<input type="hidden" value="" name="rule19" id="rule19">
<input type="hidden" value="" name="rule20" id="rule20">
</form>
</div>
</td>
</tr>

<tr>
			<td  height="25">
			</td>
</tr>
</table>
</div>
<%in page_footer.htm %>
</body>
</html>

